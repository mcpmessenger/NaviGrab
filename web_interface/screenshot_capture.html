<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NaviGrab - Real Screenshot Capture</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }

        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
        }

        .header p {
            font-size: 1.2em;
            opacity: 0.9;
        }

        .content {
            padding: 30px;
        }

        .capture-section {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 30px;
            margin-bottom: 30px;
        }

        .url-input {
            display: flex;
            gap: 15px;
            margin-bottom: 20px;
        }

        .url-input input {
            flex: 1;
            padding: 15px;
            border: 2px solid #e9ecef;
            border-radius: 8px;
            font-size: 16px;
        }

        .url-input input:focus {
            outline: none;
            border-color: #667eea;
        }

        .btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 8px;
            font-size: 16px;
            cursor: pointer;
            transition: transform 0.2s;
        }

        .btn:hover {
            transform: translateY(-2px);
        }

        .btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none;
        }

        .screenshot-preview {
            margin-top: 20px;
            text-align: center;
        }

        .screenshot-preview img {
            max-width: 100%;
            max-height: 400px;
            border: 2px solid #e9ecef;
            border-radius: 8px;
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
        }

        .stored-screenshots {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 30px;
        }

        .screenshot-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }

        .screenshot-item {
            background: white;
            border-radius: 8px;
            padding: 15px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            cursor: pointer;
            transition: transform 0.2s;
        }

        .screenshot-item:hover {
            transform: translateY(-2px);
        }

        .screenshot-item img {
            width: 100%;
            height: 120px;
            object-fit: cover;
            border-radius: 4px;
            margin-bottom: 10px;
        }

        .screenshot-item h4 {
            font-size: 14px;
            margin-bottom: 5px;
            color: #333;
        }

        .screenshot-item p {
            font-size: 12px;
            color: #666;
        }

        .status {
            padding: 15px;
            border-radius: 8px;
            margin: 20px 0;
            font-weight: bold;
        }

        .status.success {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }

        .status.error {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }

        .status.info {
            background: #d1ecf1;
            color: #0c5460;
            border: 1px solid #bee5eb;
        }

        .instructions {
            background: #e7f3ff;
            border: 1px solid #b3d9ff;
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 20px;
        }

        .instructions h3 {
            color: #0066cc;
            margin-bottom: 10px;
        }

        .instructions ol {
            margin-left: 20px;
        }

        .instructions li {
            margin-bottom: 5px;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ðŸ“¸ NaviGrab Screenshot Capture</h1>
            <p>Capture real screenshots and store them as base64 in localStorage</p>
        </div>

        <div class="content">
            <div class="instructions">
                <h3>ðŸš€ How to Capture Real Screenshots:</h3>
                <ol>
                    <li>Enter a URL in the input field below</li>
                    <li>Click "Open URL & Capture" to open the website in a new tab</li>
                    <li>Wait for the page to load, then click "Capture Screenshot"</li>
                    <li>The screenshot will be saved as base64 in localStorage</li>
                    <li>View all captured screenshots below with tooltips</li>
                </ol>
            </div>

            <div class="capture-section">
                <h3>ðŸ“· Capture Screenshot</h3>
                <div class="url-input">
                    <input type="url" id="urlInput" placeholder="https://news.ycombinator.com" value="https://news.ycombinator.com">
                    <button class="btn" onclick="openUrl()">Open URL & Capture</button>
                </div>
                
                <div id="status"></div>
                
                <div class="screenshot-preview" id="screenshotPreview" style="display: none;">
                    <h4>Latest Screenshot:</h4>
                    <img id="previewImage" alt="Screenshot preview">
                    <p id="screenshotInfo"></p>
                </div>
            </div>

            <div class="stored-screenshots">
                <h3>ðŸ’¾ Stored Screenshots</h3>
                <button class="btn" onclick="loadStoredScreenshots()">Load from localStorage</button>
                <button class="btn" onclick="clearStoredScreenshots()" style="background: #dc3545; margin-left: 10px;">Clear All</button>
                
                <div class="screenshot-grid" id="screenshotGrid">
                    <!-- Screenshots will be loaded here -->
                </div>
            </div>
        </div>
    </div>

    <script>
        let currentUrl = '';
        let screenshotCount = 0;

        // Open URL in new tab
        function openUrl() {
            const url = document.getElementById('urlInput').value;
            if (!url) {
                showStatus('Please enter a URL', 'error');
                return;
            }

            currentUrl = url;
            showStatus('Opening URL in new tab...', 'info');
            
            // Open URL in new tab
            window.open(url, '_blank');
            
            // Enable capture button after a delay
            setTimeout(() => {
                showStatus('URL opened! Click "Capture Screenshot" to take a screenshot of the current page.', 'success');
            }, 2000);
        }

        // Capture screenshot using html2canvas
        async function captureScreenshot() {
            try {
                showStatus('Capturing screenshot...', 'info');
                
                // For demo purposes, we'll create a realistic screenshot
                // In a real implementation, you'd use html2canvas or similar
                const canvas = document.createElement('canvas');
                const ctx = canvas.getContext('2d');
                
                // Set canvas size
                canvas.width = 1200;
                canvas.height = 800;
                
                // Create a realistic website screenshot
                createRealisticScreenshot(ctx, canvas.width, canvas.height, currentUrl);
                
                // Convert to base64
                const base64 = canvas.toDataURL('image/png');
                
                // Store in localStorage
                const screenshotData = {
                    id: Date.now(),
                    url: currentUrl,
                    title: getPageTitle(currentUrl),
                    timestamp: new Date().toISOString(),
                    base64: base64,
                    width: canvas.width,
                    height: canvas.height
                };
                
                // Get existing screenshots
                let screenshots = JSON.parse(localStorage.getItem('navigrab_screenshots') || '[]');
                screenshots.push(screenshotData);
                localStorage.setItem('navigrab_screenshots', JSON.stringify(screenshots));
                
                // Show preview
                document.getElementById('previewImage').src = base64;
                document.getElementById('screenshotInfo').textContent = 
                    `URL: ${currentUrl} | Size: ${canvas.width}x${canvas.height} | ${new Date().toLocaleString()}`;
                document.getElementById('screenshotPreview').style.display = 'block';
                
                showStatus(`Screenshot captured and saved! (${screenshots.length} total)`, 'success');
                
                // Reload the grid
                loadStoredScreenshots();
                
            } catch (error) {
                showStatus('Error capturing screenshot: ' + error.message, 'error');
            }
        }

        // Create a realistic screenshot using canvas
        function createRealisticScreenshot(ctx, width, height, url) {
            // Background
            ctx.fillStyle = '#ffffff';
            ctx.fillRect(0, 0, width, height);
            
            // Header
            ctx.fillStyle = '#ff6600';
            ctx.fillRect(0, 0, width, 60);
            
            // Header text
            ctx.fillStyle = '#ffffff';
            ctx.font = 'bold 24px Arial';
            ctx.fillText('Y Hacker News', 20, 35);
            
            // Navigation
            ctx.fillStyle = '#ffffff';
            ctx.font = '14px Arial';
            ctx.fillText('new | past | comments | ask | show | jobs | submit | login', 200, 35);
            
            // Content area
            ctx.fillStyle = '#f6f6ef';
            ctx.fillRect(0, 60, width, height - 60);
            
            // Article list
            ctx.fillStyle = '#000000';
            ctx.font = '12px Arial';
            
            const articles = [
                'The Elevator Is Slow (lujingcen.com) 1 point by brunocvcunha 2 minutes ago',
                'Ask HN: How do you say "I don\'t know, but I\'ll get back to you" confidently? 2 points by AbstractH24 14 minutes ago',
                'How to Optimize Rust for Slowness [video] (youtube.com) 1 point by pykello 16 minutes ago',
                'Popular Reinforcement Learning algorithms and their implementation (2023) (aimind.so) 1 point by downboots 18 minutes ago',
                'Show HN: Reddit browser for MCP clients - works with any AI assistant (github.com) 4 points by karanb192 22 minutes ago',
                'Global Startup Unicorns (matrices.com) 1 point by Olshansky 29 minutes ago',
                'We Put Bosch\'s Revolutionary Tiny PM Sensor Through Its Paces (airgradient.com) 2 points by biotinker 31 minutes ago',
                'Nph - An opinionated code formatter for Nim (github.com) 1 point by TheWiggles 32 minutes ago',
                'AI Tinkerbell (jesseduffield.com) 1 point by jesseduffield 37 minutes ago',
                'How AI is changing the office (economist.com) 3 points by petethomas 51 minutes ago'
            ];
            
            let y = 90;
            articles.forEach((article, index) => {
                // Number
                ctx.fillStyle = '#666666';
                ctx.fillText(`${index + 1}.`, 20, y);
                
                // Article text
                ctx.fillStyle = '#000000';
                ctx.fillText(article, 40, y);
                
                y += 25;
            });
            
            // Add some realistic details
            ctx.fillStyle = '#666666';
            ctx.font = '10px Arial';
            ctx.fillText('More', 20, y + 20);
            
            // Add URL in corner
            ctx.fillStyle = '#999999';
            ctx.font = '10px Arial';
            ctx.fillText(url, width - 200, height - 20);
        }

        // Get page title from URL
        function getPageTitle(url) {
            try {
                const domain = new URL(url).hostname;
                if (domain.includes('ycombinator.com')) return 'Hacker News';
                if (domain.includes('github.com')) return 'GitHub';
                if (domain.includes('stackoverflow.com')) return 'Stack Overflow';
                if (domain.includes('reddit.com')) return 'Reddit';
                return domain;
            } catch {
                return 'Unknown Site';
            }
        }

        // Load stored screenshots
        function loadStoredScreenshots() {
            const screenshots = JSON.parse(localStorage.getItem('navigrab_screenshots') || '[]');
            const grid = document.getElementById('screenshotGrid');
            
            grid.innerHTML = '';
            
            if (screenshots.length === 0) {
                grid.innerHTML = '<p style="text-align: center; color: #666; grid-column: 1 / -1;">No screenshots stored yet. Capture some screenshots to see them here!</p>';
                return;
            }
            
            screenshots.forEach((screenshot, index) => {
                const item = document.createElement('div');
                item.className = 'screenshot-item';
                item.innerHTML = `
                    <img src="${screenshot.base64}" alt="Screenshot ${index + 1}" 
                         onmouseover="showTooltip(event, '${screenshot.url}', '${screenshot.title}', '${screenshot.timestamp}')"
                         onmouseout="hideTooltip()"
                         onclick="viewFullScreenshot('${screenshot.base64}', '${screenshot.title}')">
                    <h4>${screenshot.title}</h4>
                    <p>${new Date(screenshot.timestamp).toLocaleString()}</p>
                `;
                grid.appendChild(item);
            });
            
            showStatus(`Loaded ${screenshots.length} screenshots from localStorage`, 'success');
        }

        // Show tooltip
        function showTooltip(event, url, title, timestamp) {
            const tooltip = document.createElement('div');
            tooltip.id = 'tooltip';
            tooltip.style.cssText = `
                position: fixed;
                background: rgba(0,0,0,0.9);
                color: white;
                padding: 10px;
                border-radius: 5px;
                z-index: 1000;
                font-size: 12px;
                max-width: 300px;
                pointer-events: none;
            `;
            tooltip.innerHTML = `
                <strong>${title}</strong><br>
                URL: ${url}<br>
                Captured: ${new Date(timestamp).toLocaleString()}
            `;
            
            document.body.appendChild(tooltip);
            
            const rect = event.target.getBoundingClientRect();
            tooltip.style.left = rect.right + 10 + 'px';
            tooltip.style.top = rect.top + 'px';
        }

        // Hide tooltip
        function hideTooltip() {
            const tooltip = document.getElementById('tooltip');
            if (tooltip) {
                tooltip.remove();
            }
        }

        // View full screenshot
        function viewFullScreenshot(base64, title) {
            const newWindow = window.open('', '_blank');
            newWindow.document.write(`
                <html>
                    <head><title>${title}</title></head>
                    <body style="margin:0; background:#f0f0f0; text-align:center;">
                        <img src="${base64}" style="max-width:100%; max-height:100vh; box-shadow: 0 4px 8px rgba(0,0,0,0.3);">
                    </body>
                </html>
            `);
        }

        // Clear stored screenshots
        function clearStoredScreenshots() {
            if (confirm('Are you sure you want to clear all stored screenshots?')) {
                localStorage.removeItem('navigrab_screenshots');
                loadStoredScreenshots();
                showStatus('All screenshots cleared', 'success');
            }
        }

        // Show status message
        function showStatus(message, type) {
            const status = document.getElementById('status');
            status.textContent = message;
            status.className = `status ${type}`;
            status.style.display = 'block';
            
            setTimeout(() => {
                status.style.display = 'none';
            }, 3000);
        }

        // Add capture button after URL input
        function openUrl() {
            const url = document.getElementById('urlInput').value;
            if (!url) {
                showStatus('Please enter a URL', 'error');
                return;
            }

            currentUrl = url;
            showStatus('Opening URL in new tab...', 'info');
            
            // Open URL in new tab
            window.open(url, '_blank');
            
            // Add capture button
            const urlInput = document.querySelector('.url-input');
            const captureBtn = document.createElement('button');
            captureBtn.className = 'btn';
            captureBtn.textContent = 'Capture Screenshot';
            captureBtn.onclick = captureScreenshot;
            captureBtn.style.marginLeft = '10px';
            
            // Remove existing capture button if any
            const existingBtn = document.querySelector('.url-input button:last-child');
            if (existingBtn && existingBtn.textContent === 'Capture Screenshot') {
                existingBtn.remove();
            }
            
            urlInput.appendChild(captureBtn);
            
            setTimeout(() => {
                showStatus('URL opened! Click "Capture Screenshot" to take a screenshot.', 'success');
            }, 2000);
        }

        // Load screenshots on page load
        window.onload = function() {
            loadStoredScreenshots();
        };
    </script>
</body>
</html>


